<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cotações de Frete</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-truck"></i> Sistema de Cotações de Frete</h1>
            <p class="subtitle">Obtenha cotações de frete de múltiplas transportadoras de forma rápida e eficiente</p>
        </header>

        <div class="content-grid">
            <section class="upload-section card">
                <h2><i class="fas fa-file-upload"></i> Enviar Planilha</h2>
                <p>Faça o upload do arquivo Excel com os dados para cotação de frete.</p>
                
                <form id="quoteForm" action="/process" method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="file" class="file-label">
                            <i class="fas fa-file-excel"></i>
                            <span id="file-name">Selecione o arquivo</span>
                            <input type="file" id="file" name="file" accept=".xlsx,.xls" required>
                        </label>
                        <p class="file-info">Formatos suportados: .xlsx, .xls</p>
                    </div>

                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-bar" id="progressBar"></div>
                        <span class="progress-text" id="progressText">0%</span>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <i class="fas fa-calculator"></i> Processar Cotações
                    </button>
                </form>
            </section>

            <section class="results-section card">
                <h2><i class="fas fa-clipboard-list"></i> Resultados das Cotações</h2>
                <div class="table-container">
                    <table id="resultsTable">
                        <thead>
                            <tr>
                                <th>Nota</th>
                                <th>Descrição</th>
                                <th>Transportadora</th>
                                <th>Valor Frete</th>
                                <th>Prazo (dias)</th>
                                <th>ICMS</th>
                                <th>Alíquota ICMS</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Results will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <section class="template-section card">
            <h2><i class="fas fa-download"></i> Modelo de Planilha</h2>
            <p>Baixe nosso modelo de planilha para garantir o formato correto dos dados.</p>
            <a href="/download-template" class="download-btn">
                <i class="fas fa-file-download"></i> Baixar Modelo
            </a>
        </section>

        <footer class="footer">
            <p>© 2023 Sistema de Cotações de Frete | Desenvolvido com Flask</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
